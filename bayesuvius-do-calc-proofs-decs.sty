\newcommand{\bnetInstantiations}[0]{
Random variables are underlined
and their values are not.
For example, $\rva=a$ means
the random variable
$\rva$ takes the value $a$.
Diagrams
with nodes that are
underlined represent
Bayesian Networks (bnets)
and the same diagram
with the letters not underlined
represents a specific
{\bf instantiation} of that bnet.
For example $\rva\rarrow\rvb$
represents the bnet with
conditional probability distribution
$P(b|a)$,
whereas  $a\rarrow b$
represents $P(b|a)$ itself.

If $\rva$ is a root node,
then $\sum a$ signifies
a weighted sum $\sum_a P(a)$.
For example, $\sum a\rarrow b=\sum_a P(a)P(b|a)$.
If $\rva$ is not
a root node
as in $x\rarrow\sum a \rarrow y=
\sum_a P(y|a)P(a|x) $, then
$\sum a$ signifies
a simple unweighted sum $\sum_a$.}


\newcommand{\hiddenNodes}[0]{
Unobserved nodes are
indicated by enclosing them
in a dashed circle. For example,
$\xymatrix{*++[F-o]{u}}$.
}



\newcommand{\selectionGraphs}
[0]{In a selection
diagram
with a selection 
node $\rvs\in \bool$,
if  a node $\rvx$
has parents $pa(\rvx)$
where $\rvs\not\in pa(\rvx)$,
then the
TPM of $\rvx$ is $P(x|pa(x))$.
If, on the other hand,
$\rvx$ has 
parents $pa(\rvx)\cup
\rvs$, then
the TPM of $\rvx$ is
$P(x|pa(x), s)$, where
$P(x|pa(x), \rvs=0)=P(x|pa(x))$
and $P(x|pa(x),\rvs=1)=
P^*(x|pa(x))$.}

\newcommand{\decBackDoor}[0]{
 (Backdoor
Adjustment Formula)

If
$
\xymatrix{
{\rvz}\ar[d]\ar[rd]
\\
\rvx\ar[r]&\rvy
}$
then

\beq
P(y|\cald \rvx = x)=
\sum_z
P(y|x,z)P(z)
\eeq
\beq
\xymatrix{
\cald\rvx=x\ar[r]
&y
}\xymatrix{\\=}
\xymatrix{
\sum z\ar[dr]
\\
x\ar[r]
&y
}
\eeq
 }



\newcommand{\decFrontDoor}[0]{(Frontdoor
Adjustment Formula)

If
$
\xymatrix{
&*++[F-o]{\rvc}\ar[ld]\ar[rd]
\\
\rvx\ar[r]&\rvm\ar[r]&\rvy
}$
then
\beq
P(y|\cald \rvx = x)=
\sum_m
\left[
\sum_{x'}P(y|x',m)P(x')
\right]P(m|x)
\eeq

\beq
\xymatrix{
\cald\rvx=x\ar[r]
&y
}\xymatrix{\\=}
\xymatrix{
&\sum x'\ar[dr]
\\
xÂ´\ar[r]
&\sum m\ar[r]&y
}
\eeq
}


\newcommand{\decNapkin}[0]{(Napkin problem from Ref.\cite{book-why})

If $
\xymatrix{
&*++[F-o]{\rvu_1}\ar[ddl]\ar[ddrr]
\\
&*++[F-o]{\rvu_2}\ar[dl]\ar[dr]
\\
\rvw\ar[r]
&\rvz\ar[r]
&\rvx\ar[r]
&\rvy
}$ then
\beq
P(y|\cald \rvx = x)
=\sum_{w,z}P(y|x, w,z)P(w,z)
\eeq

\beq
\xymatrix{
\\
\cald\rvx=x\ar[r]&y
}
\quad
\xymatrix{
\\=}
\xymatrix{
\sum w,z\ar[dr]
\\
x\ar[r]
&y}
\eeq
}

\newcommand{\decWhy}[0]{(from Ref.\cite{book-why})

If $
\xymatrix{
\rvx\ar[d]\ar[drr]
\\
\rvw\ar[r]
&\rvz\ar[r]
&\rvy
\\
*++[F-o]{\rvu}\ar[u]\ar[urr]
}$ then
\beq
P(y|\cald\rvz=z, x)
=
\sum_w
P(y|z,x,w)P(w)
\eeq 
\beq
\xymatrix{
x\ar[rrd]
\\
&\cald\rvz=z\ar[r]
&y
}
\quad
\xymatrix{\\=}
\quad
\xymatrix{
x\ar[rrd]
\\
\sum w\ar@/_1pc/[rr]
&z\ar[r]
&y
}\eeq
}


\newcommand{\decTransportTrivial}[0]
{(Trivial Memoryless
 Transportability,
from Ref.\cite{pearl2011trans})

If $
\xymatrix{
&\rvz\ar[ld]\ar[rd]
&\rvs\ar[d]
\\
\rvx\ar[rr]
\ar@{<-->}@/^1pc/[ru]
\ar@{<-->}@/_1pc/[rr]
&&\rvy
}$ 
where $\rvs\in\bool$ is a 
selection node,
then

\beq
P^*(y|\cald \rvx=x, z)=P^*(y|x, z)
\quad
\text{(replace $\cald$ by $1$, 
keep $P^*$)}
\eeq

\beq
\xymatrix{
&z\ar[rd]
&\rvs=1\ar[d]
\\
\cald\rvx=x\ar[rr]
&&y
}
\xymatrix{
\\=
}
\xymatrix{
&z\ar[rd]
&\rvs=1\ar[d]
\\
x\ar[rr]
&&y
}
\eeq
}

\newcommand{\decTransportDirect}[0]
{(Direct
 Transportability, a.k.a.
External Validity,
from Ref.\cite{pearl2011trans})

If $
\xymatrix{
\rvs\ar[r]
&\rvz\ar[ld]\ar[rd]
&
\\
\rvx\ar[rr]
\ar@{<-->}@/^1pc/[ru]
\ar@{<-->}@/_1pc/[rr]
&&\rvy
}$ 
where $\rvs\in\bool$ is a 
selection node,
then

\beq
P^*(y|\cald\rvx=x, z)=
P(y|\cald\rvx=x, z)
\quad
\text{(replace $P^*$ by $P$, 
keep $\cald$)}
\eeq

\beq
\xymatrix{
\rvs=1\ar[r]
&z\ar[dr]
&
\\
\cald\rvx=x\ar[rr]
&&y
}
\xymatrix{\\=}
\xymatrix{
&z\ar[dr]
&
\\
\cald\rvx=x\ar[rr]
&&y
}\eeq
Furthermore,
\beq
P^*(y|\cald \rvx=x)=
\sum_z
P(y|\cald \rvx=x,z)P^*(z)
\eeq

\beq
\xymatrix{
\rvs=1\ar[drr]
\\
\cald \rvx=x\ar[rr]
&&y
}\xymatrix{\\=}
\xymatrix{
\rvs=1\ar[r]
&\sum z\ar[rd]
\\
\cald\rvx=x\ar[rr]
&&y
}
\eeq
}



\newcommand{\decTransportBox}[0]
{(S-Admisssible Transportability,
from Ref.\cite{pearl2011trans})

If
$
\xymatrix{
\rvs\ar[r]
&*++[F-o]{\rvz}\ar[r]\ar[ld]
&\rva\ar[d]
\\
\rvx\ar[rr]
\ar@{<-->}@/^1pc/[ru]
\ar@{<-->}@/_1pc/[rr]
&&\rvy
\\
\\
}$ 
where $\rvs\in\bool$ is a 
selection node,
then

\beq
P^*(y|\cald \rvx=x)=
\sum_{a}P(y|\cald \rvx=x, a)P^*(a)
\eeq
\beq
\xymatrix{
\rvs=1\ar[dr]
\\
\cald \rvx=x\ar[r]
&y
}\xymatrix{\\=}
\xymatrix{
\rvs=1\ar[r]
&\sum a\ar[d]
\\
\cald \rvx=x\ar[r]
&y
}
\eeq
}

%\decTransportOne merged 
%with decDirectTransport

\newcommand{\decTransportNon}[0]
{(Non-transportability,
from Ref.\cite{pearl2011trans})

If $
\xymatrix{
&*++[F-o]{\rvh}\ar[ld]\ar[rd]
&\rvs\ar[d]
\\
\rvx\ar[rr]
&&\rvy
}$ 
where $\rvs\in\bool$ is a 
selection node,
then

\beq
P^*(y|\cald \rvx=x)=
P^*(y|\cald\rvx=x)
\eeq

\beq
\xymatrix{
&
&\rvs=1\ar[d]
\\
\cald\rvx=x\ar[rr]
&&y
}
\xymatrix{
\\=\text{same}
}
\eeq
}

\newcommand{\decTransportTwo}[0]{(from Ref.\cite{pearl2011trans})
\\
\\

If
$\xymatrix{
\rvs\ar@/^1.5pc/[rr]
&*++[F-o]{\rvh}\ar[dl]\ar[dr]\ar[r]
\ar@{<-->}@/_1pc/[dl]
&\rvz
\\
\rvx\ar[rr]\ar@{<-->}@/_1pc/[rr]
&&\rvy
}$ 
where $\rvs\in\bool$ is a 
selection node,
then

\beq
P^*(y|\cald \rvx=x)=
P(y|\cald \rvx=x)
\eeq
\beq
\xymatrix{
\rvs=1\ar[drr]
\\
\cald \rvx=x\ar[rr]
&&y
}\xymatrix{\\=}
\xymatrix{
\\
\cald \rvx=x\ar[rr]
&&y
}
\eeq
}

\newcommand{\decTransportThree}[0]{(from Ref.\cite{pearl2011trans})

If
$\xymatrix{
\rvs\ar[rd]
&*++[F-o]{\rvh}\ar[dl]\ar[dr]
\ar@{<-->}@/_1pc/[dl]
\\
\rvx\ar[r]\ar@{<-->}@/_1pc/[rr]
&\rvz\ar[r]
&\rvy
}$ 
where $\rvs\in\bool$ is a 
selection node,
then

\beq
P^*(y|\cald \rvx=x)=
\sum_z
P(y|\cald \rvx=x, z)P^*(z|x)
\eeq
\beq
\xymatrix{
\rvs=1\ar[dr]
&\cald\rvx=x\ar[d]
\\
&y
}
\xymatrix{
\\=}
\xymatrix{
\rvs=1\ar[rd]
&&\cald\rvx=x\ar[d]
\\
x\ar[r]
&\sum z\ar[r]
&y
}
\eeq
}

\newcommand{\decMediationSimple}
[0]{(Unconfounded Mediation,
from Ref.\cite{pearl-2019review})

If 
$\xymatrix{
&\rvm\ar[rd]
\\
\rvd\ar[rr]\ar[ru]
&&\rvy}$
then

\beq
P(y|\cald\rvd=d, \cali_\rvm\rvd=d')=
\sum_m
P(y|d, m)
P(m|d')
\eeq

\beq
\xymatrix{
\cali\rvd=d'\ar[rd]
\\
\cald\rvd=d\ar[r]
&y
}
\xymatrix{\\=}
\xymatrix{
\cali\rvd=d'\ar[r]
&\sum m\ar[rd]
\\
\cald \rvd=d\ar[rr]
&&y}
\eeq
}

\newcommand{\decMediationPlus}
[0]{(Mediation 
with universal prior $\rvxi$
and universal confounder $\rvu$,
from Ref.\cite{pearl-2019review})

If 
$\xymatrix{
&*++[F-o]{\rvu}\ar[dl]
\ar[ddr]\ar[ddl]\ar[d]
\\
\rvxi\ar[rrd]\ar[d]\ar[r]
&\rvm\ar[rd]
\\
\rvd\ar[rr]\ar[ru]
&&\rvy}$
then

\beq
P(y|\cald\rvd=d, \cali_\rvm\rvd=d')=
\sum_\xi
\sum_m
P(y|d, m, \xi)
P(m|d', \xi)P(\xi)
\eeq

\beq
\xymatrix{
\cali\rvd=d'\ar[rd]
\\
\cald\rvd=d\ar[r]
&y
}
\xymatrix{\\=}
\xymatrix{
\cali\rvd=d'\ar@/_1pc/[rr]
&\sum\xi\ar[rrd]\ar[r]
&\sum m\ar[rd]
\\
\cald \rvd=d\ar[rrr]
&&&y}
\eeq
}


\newcommand{\decSeqBackDoor}[0]{(Sequential 
backdoor adjustment formula)

If 
\xymatrix{
\rvz_0\ar[r]\ar@/^1pc/[rr]\ar[drrr]
\ar[dd]
&\rvz_1\ar[r]\ar[drr]
\ar[dd]
&\rvz_2\ar[dr]
\ar[dd]
\\
&&&\rvy
\\
\rvx_0\ar[uur]\ar[uurr]\ar[urrr]
&\rvx_1\ar[uur]
\ar[urr]
&\rvx_2
\ar[ur]
}
then

\begin{align}
P(y|\cald \rvx^3=x^3)
&=
\calq(y|x^3)
\\
\nonumber
\\
&
\xymatrix{\\=}
\xymatrix{
\sum z_0\ar[r]\ar@/^1pc/[rr]
\ar[drrr]
&\sum z_1\ar[r]
\ar[drr]
&\sum z_2
\ar[dr]
\\
&&&y
\\
x_0\ar[uur]\ar[uurr]
\ar[urrr]
&x_1\ar[uur]
\ar[urr]
&x_2
\ar[ur]
}
\end{align}
The result
shown here for $n=3$
is true for any integer $n\geq 1$.
}