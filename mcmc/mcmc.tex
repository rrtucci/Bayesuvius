\chapter{Markov Chain Monte Carlo (MCMC)}

\section*{Inverse of Cumulative Sampling}
%https://en.wikipedia.org/wiki/Inverse_transform_sampling
\beq
CUM_\rvx(x)=P(\rvx<x)=
\int_{x'<x} dx'\;P_\rvx(x')
\eeq

\beqa
P(CUM^{-1}_\rvx(\rvu)<x)
&=&P(\rvu<CUM_\rvx(x))
\\
&=&CUM_\rvx(x)
\eeqa


\begin{figure}[h!]
$$\xymatrix{
\rvu^{(0)}\ar[d]
&\rvu^{(1)}\ar[d]
&\rvu^{(2)}\ar[d]
\\
\ul{\vecx}^{(0)}\ar[r]
&\ul{\vecx}^{(1)}\ar[r]
&\ul{\vecx}^{(2)}
}$$
\caption{Inverse Cumulative sampling}
\label{}
\end{figure}

\beq\color{blue}
P(u^{(t)})=1
\eeq

\beq\color{blue}
P(\vecx^{(t)}|\vecx^{(t-1)}, u^{(t)})=
\indi(\;\;\;\vecx^{(t)}=
\vecx^{(t-1)}\oplus CUM^{-1}_\rvx(u^{(t)})
\;\;\;)
\eeq


\section*{Rejection Sampling}
%https://en.wikipedia.org/wiki/Rejection_sampling

\begin{figure}[h!]
$$\xymatrix{
&\rvu^{(0)}\ar[d]
&&\rvu^{(1)}\ar[d]
&&\rvu^{(2)}\ar[d]
\\
\ul{\vecx}^{(0)}\ar@/^1pc/[rr]
&\rva^{(0)}\ar[r]
&
\ul{\vecx}^{(1)}\ar@/^1pc/[rr]
&\rva^{(1)}\ar[r]
&
\ul{\vecx}^{(2)}\ar@/^1pc/[rr]
&\rva^{(2)}\ar[r]
&\ul{\vecx}^{(3)}
\\
&\rvc^{(0)}\ar[u]\ar[ru]
&&\rvc^{(1)}\ar[u]\ar[ru]
&&\rvc^{(2)}\ar[u]\ar[ru]
}$$
\caption{Rejection Sampling}
\label{}
\end{figure}

\beq
P_\rvx(x)< \beta P_\rvc(x)
\eeq

\beq\color{blue}
P(u^{(t)}=u)=1
\eeq

\beq\color{blue}
P(\rvc^{(t)}=x)=P_\rvc(x)
\eeq

\beq\color{blue}
P(\rva^{(t)}=a|\rvc^{(t)}=x,
\rvu^{(t)}=u)=
\left\{
\begin{array}{ll}
\indi(a=0)&\text{ if }
u \beta P_\rvc(x)\geq P_\rvx(x))
\\
\indi(a=1)&\text{ if }
u \beta P_\rvc(x)< P_\rvx(x))
\end{array}
\right.
\eeq

\beq\color{blue}
P(\vecx^{(t)}|
\vecx^{(t-1)}, \rva^{(t)}=a, \rvc^{(t)}=x)
=
\left\{
\begin{array}{ll}
\indi(\vecx^{(t)}=\vecx^{(t-1)})
& \text{ if $a=0$}
\\
\indi(\vecx^{(t)}=\vecx^{(t-1)}\oplus x)
&\text{ if $a=1$}
\end{array}
\right.
\eeq


\section*{Importance Sampling}
\section*{Metropolis-Hastings Sampling}
\begin{figure}[h!]
$$\xymatrix{
&\rvu^{(0)}\ar[d]
&&\rvu^{(1)}\ar[d]
&&\rvu^{(2)}\ar[d]
\\
\ul{\vecx}^{(0)}\ar@/^1pc/[rr]
&\rva^{(0)}\ar[r]
&
\ul{\vecx}^{(1)}\ar@/^1pc/[rr]\ar[rdd]
&\rva^{(1)}\ar[r]
&
\ul{\vecx}^{(2)}\ar@/^1pc/[rr]\ar[rdd]
&\rva^{(2)}\ar[r]
&\ul{\vecx}^{(3)}
\\
&\rvc^{(0)}\ar[u]\ar[ru]
&&\rvc^{(1)}\ar[u]\ar[ru]
&&\rvc^{(2)}\ar[u]\ar[ru]
\\
&\rvm^{(0)}\ar[u]\ar@/^1pc/[uu]
&&\rvm^{(1)}\ar[u]\ar@/^1pc/[uu]
&&\rvm^{(2)}\ar[u]\ar@/^1pc/[uu]
}$$
\caption{Metropolis-Hastings sampling}
\label{}
\end{figure}


\section*{Gibbs Sampling}