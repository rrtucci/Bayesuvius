\chapter{Finite State Machine}
\label{ch-finite-state}





Let $|S|$ denote the number of elements
in a set $|S|$.
The {\bf power set of set $S$}, denoted by $2^S$,
is the set of all the subsets of $S$, including the empty set.
Note that $|2^S|=2^{|S|}$. Indeed
consider the binomial expansion

\beq
(1 + 1)^{|S|}=\sum_{i=0}^{|S|}{|S| \choose i}
\eeq
Now note that  ${|S|\choose i}$
is the number of subsets of $S$ with $i$ elements.

Consider a function
$f:A\rarrow B$. 

The {\bf range} of $f$ is $B$.

The {\bf image} of $f$
is $Im(f)=\{f(a): a\in A\}$. 

$f$ is {\bf 1-1} if $f(a_1)=f(a_2)$
implies $a_1=a_2$.


$f$ is {\bf onto} if $Im(f)=B$.

\section{Deterministic FSM}

\subsection{Example}

\begin{figure}[h!]
$$
\begin{array}{cccc}
\xymatrix@C=3pc@R=3pc{
\PinkCircle{\rvp_1}\ar@/^1pc/[r]|a
&
\Circle{\rvp_2}\ar@/^1pc/[l]|b
\ar[d]|c \ar@(ru,lu)[]|a
\\
\Circle{\rvp_3}\ar@/^1pc/[r]|b
\ar[u]|a
&\DCircle{\rvp_4}\ar@/^1pc/[l]|d
}&
\xymatrix@C=3pc@R=3pc{
\Circle{\rvp_1}\ar@/^1pc/[r]|a
&
\PinkCircle{\rvp_2}\ar@/^1pc/[l]|b
\ar[d]|c \ar@(ru,lu)[]|a
\\
\Circle{\rvp_3}\ar@/^1pc/[r]|b
\ar[u]|a
&\DCircle{\rvp_4}\ar@/^1pc/[l]|d
}&
\xymatrix@C=3pc@R=3pc{
\Circle{\rvp_1}\ar@/^1pc/[r]|a
&
\PinkCircle{\rvp_2}\ar@/^1pc/[l]|b
\ar[d]|c \ar@(ru,lu)[]|a
\\
\Circle{\rvp_3}\ar@/^1pc/[r]|b
\ar[u]|a
&\DCircle{\rvp_4}\ar@/^1pc/[l]|d
}&
\xymatrix@C=3pc@R=3pc{
\Circle{\rvp_1}\ar@/^1pc/[r]|a
&
\Circle{\rvp_2}\ar@/^1pc/[l]|b
\ar[d]|c \ar@(ru,lu)[]|a
\\
\Circle{\rvp_3}\ar@/^1pc/[r]|b
\ar[u]|a
&\PinkDCircle{\rvp_4}\ar@/^1pc/[l]|d
}
\end{array}
$$
\caption{Example of deterministic FSM. Pink nodes carry the single pink token which is present at 
some place node at all times.
The history of the pink node traces out the string \qt{aac}.}
\label{fig-eg-det-fsm}
\end{figure}

\subsection{Precise Definition}
{\bf Finite State Machine} (FSM) (a.k.a. {\bf Finite Automaton}, (FA))

$\calx =\{\rvx_i\}_{i=1}^{nx}$ are the {\bf transition nodes} of the pnet.

$\calp =\{\rvp_i\}_{i=1}^{np}$ are the {\bf place (or state) nodes} of the pnet.

$\calx(\rvp\rarrow)=\{\rvx: \rvp\rarrow\rvx \text{ is an arrow of the pnet}\}$.

\hrule
New terms and notation:

A FSM contains exactly one {\bf pink place node}. We will 
say that this pink place node contains the {\bf pink token}.
Each transition appends a string to the {\bf history of the pink token}.

$\calp_{acc}\subset \calp$ are the 
{\bf accepting places}. Places which, if reached by the pink token, terminate the pink token history.

$\Sigma=$ {\bf alphabet}, a finite set of symbols
from which to create strings. For example,
$\Sigma$ might be $\{0, 1\}$ or $\{a, b, c\}$.

$f_\rvp:\calx(\rvp\rarrow)\rarrow \Sigma$ for each
$\rvp\in \calp$,  is the 
{\bf transition function} for place node $\rvp$. 

$f_\calp =
\{f_\rvp: \rvp\in \calp\}$

$\rvp_{i(0)}\in \calp$, {\bf starting place }
\hrule
Recall from Chapter \ref{ch-petri} that a Petri net is defined as $\Phi_{pnet} = \av{\calp, \calx, W,\ket{b(0)}_\calp}$.
A {\bf Finite Automaton (FA)}
is defined by adding extra stuff to
$\Phi_{pnet}$, namely by
$\Phi_{FA}=\av{\Phi_{pnet},\calp_{acc}, \Sigma, f_\calp}$.
$\ket{b(0)}_\calp$ in the definition
of $\Phi_{pnet}$ is replaced by
$\rvp_{i(0)}\in\calp$.

\begin{mdframed}[hidealllines=true,backgroundcolor=blue!10]
For a {\bf deterministic FA}:
\begin{itemize}
\item For each $\rvp\in\calp$, the function $f_\rvp:\calx(\rvp\rarrow)\rarrow \Sigma$ is 1-1.

\item
we will often indicate a node for 
which $f_{\rvp}(\rvx_i)=a$ either by $\rvx_i=a$
or simply by $a$. 
\end{itemize}\end{mdframed}

\section{Non-deterministic FSM}
\subsection{Simple Example}

\begin{figure}
$$
\xymatrix{
&\Circle{\rvp_1}\ar[r]|0
&\Circle{\rvp_2}\ar[r]|1
&\DCircle{\rvp_3}
\\
\PinkCircle{\rvp_4}\ar@(ru,lu)[]|{0,1}
\ar[ru]|\emptyset
\ar[rd]|\emptyset
\\
&\Circle{\rvp_5}\ar[r]|1
&\Circle{\rvp_6}\ar[r]|0
&\DCircle{\rvp_7}
}
$$
\caption{
Example of a 
non-deterministic FSM.}
\label{fig-non-det-fsm}
\end{figure}


\subsection{Precise Definition}

\begin{mdframed}[hidealllines=true,backgroundcolor=blue!10]
For a {\bf non-deterministic FA}:
\begin{itemize}
\item
$f_\rvp:\calx(\rvp\rarrow)\rarrow 2^\Sigma$ 
instead of 
$f_\rvp:\calx(\rvp\rarrow)\rarrow \Sigma$ (i.e., the range of $f_\rvp$
is the power set of $\Sigma$ 
instead of $\Sigma$).
The function $f_\rvp$ is not necessarily
1-1.
Note that the new range contains the empty set.
If $f_\rvp(\rvx)=\emptyset$, we say there is a  {\bf null transition} for arrow 
$\rvp\rarrow \rvx$.\footnote{The empty set is sometimes denoted by $\eps$ 
when discussing FSM.} A null transition 
transfers the node accross without adding anything to the token history. 
\item
we will often indicate a node for 
which $f_{\rvp}(\rvx_i)=\{a,b, \ldots\}\subset\Sigma$ either by $\rvx_i=a, b, \ldots$
or simply by $a, b, \ldots$. 
\end{itemize}\end{mdframed}

\section{Equivalency of deterministic and non-deterministic FSM}