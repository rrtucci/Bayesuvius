\chapter{Renormalization Group for Bayesian Networks}
\label{ch-renorm-group-bnets}
\section{Information Theory Conventions}
\beq
H(\rvx)=-\sum_{x\in val(\rvx)} P(x)\ln P(x)
\eeq

\beq
H(\rvy\mid \rvx) =-
\sum_{x\in val(\rvx)}
\sum_{y\in val(\rvy)}
P(x,y)\ln P(y|x)
\eeq

\beqa
H(\rvx:\rvy)&=&\sum_{x\in val(\rvx)}
\sum_{y\in val(\rvy)}
P(x,y)\ln \frac{P(x,y)}{P(x)P(y)}
\\
&=& H(\rvy)-H(\rvy|\rvx)=H(\rvx)-H(\rvx|\rvy)
\eeqa


\begin{claim}
\beq
0\leq H(\rvx)\leq \ln|val(\rvx)|
\eeq
\beq
0\leq H(\rvx: \rvy)\leq \min(H(\rvx), H(\rvy))
\eeq
\end{claim}
\proof

The minimum occurs when $P(x,y)=P(x)P(y)$
(i.e., $\rvx$ and $\rvy$ are uncorrelated).

The maximum occurs when $\rvx$ becomes
deterministic 
or $\rvy$ becomes deterministic. 
When $\rvx$ becomes deterministic,

\beq
H(\rvx|\rvy)=0\implies 
 H(\rvx: \rvy)= H(\rvx)
\eeq
Likewise, when $\rvy$ becomes determinstic, 
$H(
\rvx: \rvy)= H(\rvy)$
\qed

\begin{claim}

\beq
\sum_{i=1}^n H(\rvx_i)-H(\rvx^{:n})=
\sum_{i\in I_{NR}} H(\rvx_i : pa(\rvx_i))
\leq \sum_{i\in I_{NR}}H(\rvx_i)
\eeq
Note that both sides equal zero
when all the nodes are uncorrelated.
\end{claim}
\proof

\beq
H(\rvx_i : pa(\rvx_i))=
\sum_{x_i\in \ZZ_\pm}\sum_{pa(\rvx_i)\in \ZZ^2_{\pm}}P(x_i, pa(\rvx_i))
\ln \frac{P(x_i\mid pa(\rvx_i))}{P(x_i)}
\eeq

\beq
H(\rvx_i)=-\sum_{x_i\in \ZZ_\pm}P(x_i)\ln P(x_i)
\eeq

\beq
H(\rvx^{:n})=-\sum_{x^{:n}\in \ZZ^n_\pm}P(x^{:n})\ln P(x^{:n})
\eeq

\beq
\frac{P(x^{:n})}{\prod_{i=1}^n
P(x_i)}=\prod_{i\in I_{NR}}  \frac{P(x_i\mid pa(\rvx_i))}{P(x_i)}
\eeq


\beq
\sum_{x^{:n}\in \ZZ_{\pm}^n}P(x^{:n})\ln \frac{P(x^{:n})}{\prod_{i=1}^n P(x_i)}=
\sum_{i\in I_{NR}}H(\rvx_i : pa(\rvx_i))
\eeq

\qed

\section{Scaling a General Bnet}

Let

$\calr=$ set of root nodes. 

$\calr^c=$ set of non-root indices.

$n=$ total number of nodes

$x^{:n}= (x_1, x_2, \ldots, x^n)$


\beq
P(x^{:n}) = \left[ \prod_{\rvx_i\in \calr^c}P(x_i\mid pa(\rvx_i))\right]\prod_{\rvx_i\in\calr}P(x_i)
\eeq

$1<b<\infty$
\beq
P(x_i\mid pa(\rvx_i); b)=
\frac{P(x_i\mid pa(\rvx_i))^b}
{Z_i}
\eeq

\beq
Z_i=\sum_{x_i\in val(x_i)}P(x_i\mid pa(\rvx_i))^b
\eeq

As $b\rarrow \infty$,

\beq
P(x_i\mid pa(\rvx_i); b)\rarrow \delta[1, \max_i P(x_i\mid pa(\rvx_i);b=1)]
\eeq



\section{Scaling the Bnet for a cubic Ising Model}

\begin{figure}[h!]
$$
\bcen
\xymatrix{
\rvS_i\ar@{-}[r]&\rvS_j
}
\ecen
=
\bcen
\xymatrix@R=1pc@C=3pc{
\rvS_i^X\ar[dr]\ar[d]
&\rvS_j^X\ar[dl]\ar[d]
\\
\rvS_i^Y
&\rvS_j^Y
}
\ecen
$$
\caption{DAG definition of undirected arrow.}
\label{fig-def-undir-ar-dag}
\end{figure}

\subsection{1-dim Ising Model}

$Bool=\bool$

 
$S_i, S_i^X, S_i^Y\in \{1, -1\} =2 Bool-1=\ZZ_\pm$

$D_i=(S_i^X, S_i^Y)$ (\qt{dipole node})

$
b = \beta = 1/T
$

\begin{figure}[h!]
$$
\bcen
\xymatrix{
\rvS_1\ar@{-}[r]
&\rvS_2\ar@{-}[r]
&\rvS_3
}
\ecen
=
\bcen
\xymatrix@R=1pc@C=3pc{
\rvS_1^X\ar[dr]\ar[d]
&\rvS_2^X\ar[dl]\ar[dr]\ar[d]
&\rvS_3^X\ar[dl]\ar[d]
\\
\rvS_1^Y
&\rvS_2^Y
&\rvS_3^Y
}
\ecen
$$
\caption{DAG definition of 1-dim Ising Model}
\label{fig-def-1dim-ising}
\end{figure}

For $i=1,2,3$
\beq\color{blue}
P(S_i^X)=\quad\text{given}
\eeq

\beq
\left\{
\begin{array}{l}
\color{blue}
P(S_2^Y\mid S_2^X, S_1^X, S_3^X)
=\frac{e^{-\beta\calh_2}}{Z_2}
\\
\calh_2 = g S_2^Y(S_1^X + S_3^X) + h S_2^Y -\lam_2(S_2^Y-S_2^X),\quad
\lam_2\rarrow \infty
\\
Z_2 = \sum_{S^Y_2\in \ZZ_{\pm}}e^{-\beta\calh_2}
\end{array}
\right.
\eeq

For $i=1,3$
\beq
\left\{
\begin{array}{l}
\color{blue}
P(S_i^Y\mid S_i^X, S_2^X)
=\frac{e^{-\beta\calh_1}}{Z_i}
\\
\calh_i = g S_i^Y(S_2^X) + h S_i^Y -\lam_i(S_i^Y-S_i^X),\quad
\lam_i\rarrow \infty
\\
Z_i = \sum_{S^Y_i\in \ZZ_{\pm}}e^{-\beta\calh_i}
\end{array}
\right.
\eeq



\subsection{2-dim Ising Model}

$\calb=$ border nodes of undirected graph

$\calb^c=$ non-border, internal 
nodes of undirected graph

$n=$ number of nodes
of undirected graph

\begin{figure}[h!]
$$
\bcen
\xymatrix{
\rvS_1\ar@{-}[r]\ar@{-}[d]
&\rvS_2\ar@{-}[r]\ar@{-}[d]
&\rvS_3\ar@{-}[d]
\\
\rvS_4\ar@{-}[r]\ar@{-}[d]
&\rvS_5\ar@{-}[r]\ar@{-}[d]
&\rvS_6\ar@{-}[d]
\\
\rvS_7\ar@{-}[r]
&\rvS_8\ar@{-}[r]
&\rvS_9
}
\ecen
=
\bcen
\xymatrix@R=1pc@C=3pc{
\rvS_1^X\ar[dr]\ar[d]
\ar@[red]@/_1pc/[ddd]
&\rvS_2^X\ar[dl]\ar[dr]\ar[d]
\ar@[red]@/_1pc/[ddd]
&\rvS_3^X\ar[dl]\ar[d]
\ar@[red]@/_1pc/[ddd]
\\
\rvS_1^Y
&\rvS_2^Y
&\rvS_3^Y
\\
\rvS_4^X\ar[dr]\ar[d]
\ar@[red]@/_1pc/[u]
\ar@[red]@/^1pc/[ddd]
&\rvS_5^X\ar[dl]\ar[dr]\ar[d]
\ar@[red]@/_1pc/[u]
\ar@[red]@/^1pc/[ddd]
&\rvS_6^X\ar[dl]\ar[d]
\ar@[red]@/_1pc/[u]
\ar@[red]@/^1pc/[ddd]
\\
\rvS_4^Y
&\rvS_5^Y
&\rvS_6^Y
\\
\rvS_7^X\ar[dr]\ar[d]
\ar@[red]@/^1pc/[u]
&\rvS_8^X\ar[dl]\ar[dr]\ar[d]
\ar@[red]@/^1pc/[u]
&\rvS_9^X\ar[dl]\ar[d]
\ar@[red]@/^1pc/[u]
\\
\rvS_7^Y
&\rvS_8^Y
&\rvS_9^Y
}
\ecen
$$
\caption{DAG definition of 2-dim Ising Model}
\label{fig-def-2dim-ising}
\end{figure}

For $i=1,2, \ldots, n$
\beq\color{blue}
P(S_i^X)=\quad\text{given}
\eeq

For $\rvS_i\in \calb^c$, if 
$\rvS_a, \rvS_b, \rvS_c, \rvS_d$ are the nearest
neighbors (nn) of $\rvS_i$,
\beq
\left\{
\begin{array}{l}
\color{blue}
P(S_i^Y\mid S_i^X, S_a^X, S_b^X, S_c^X, S_d^X)
=\frac{e^{-\beta\calh_i}}{Z_i}
\\
\calh_i = g S_i^Y(S_i^X+S_a^X+ S_b^X, S_c^X+ S_d^X) + h S_i^Y -\lam_i(S_i^Y-S_i^X),\quad
\lam_i\rarrow \infty
\\
Z_i = \sum_{S^Y_i\in \ZZ_{\pm}}e^{-\beta\calh_i}
\end{array}
\right.
\label{eq-ising-tpm-non-border}
\eeq

For $\rvS_i\in \calb$, the corner nodes have 2 nn and the non-corner ones have 3 nn. Eq.(\ref{eq-ising-tpm-non-border}) is valid for $\rvS_i\in \calb$ if we set $\rvS_c=\rvS_d=0$ in case
of 2 nn and $\rvS_d=0$ in case of 3 nn.


\beq
P(D^{:n})=
\left[\prod_{i=1}^n  P(S_i^Y\mid pa(\rvS_i^Y))\right]
\prod_{i=1}^n P(S_i^X)
\eeq





