\chapter{Modified Treatment Policy}
\label{ch-modi-treat}

This  chapter
assumes that the
reader has
already read
Chapter \ref{ch-pot-out} on Potential Outcomes (PO) theory.

Consider a typical PO bnet $G$
and its corresponding imagined bnet $G_{im}$ (see Fig.\ref{fig-modi-po}).
A {\bf Modified Treatment Policy (MTP)} adds a Bayesian prior to the
 node $\ul{\tild}$ in $G_{im}$.
The prior depends on the {\bf treatment
variable} (a.k.a., {\bf exposure variable}) $\rvd$ and its parents $pa(\rvd)$.
This adds arrows $pa(\rvd)\rarrow\ul{\tild}$
and $\rvd\rarrow \ul{\tild}$ (see Fig.\ref{fig-unmodi-modi}).
An ATE is calculated by removing all arrows entering $\ul{\tild}$
so as to mimic a RCT. Hence, a MTP cannot be used to calculate
an ATE or mimic an RCT.


\begin{figure}[h!]
$$
\begin{array}{cc}
\xymatrix{
\rvx
\ar[dd]\ar[ddrr]
\\
\\
\rvd \ar[rr]
&
&\rvy
}
&
\xymatrix{
\rvx
\ar[dd]\ar[dr] \ar[drr]
\\
& \rvy(0)\ar[dr]
&\rvy(1)\ar[d]
\\
\rvd
&\ul{\tild}=\tild\ar[r]
&\rvy
}
\\
G & G_{im}
\end{array}
$$
\caption{$G$ is one of the
simplest possible bnets considered in  PO theory.
$G_{im}$ is the bnet that results
from applying the imagine operator to $G$.
For $G_{im}$, $\tild\in S_{\ul{\tild}}=S_\rvd=\bool$.}
\label{fig-modi-po}
\end{figure}


\begin{figure}[h!]
$$
\begin{array}{cc}
\xymatrix{
pa(\rvd)
\ar[dd]
&
&pa'(\rvy)\ar[d]
\\
&&[\rvy(\tild)]_{d\in S_{\ul{\tild}}}\ar[d]
\\
\rvd
&\ul{\tild}=\tild\ar[r]
&\rvy
}
&
\xymatrix{
pa(\rvd)
\ar[dd]\ar[ddr]
&
&pa'(\rvy)\ar[d]
\\
&&[\rvy(\tild)]_{\tild\in S_{\ul{\tild}}}\ar[d]
\\
\rvd\ar[r]
&\ul{\tild}\ar[r]
&\rvy
}
\\
G_{im}
 &
G_{im,mod}
\end{array}
$$
\caption{In this figure, $G_{im}$
is the generalization of the $G_{im}$
in Fig.\ref{fig-modi-po}.
Note that $pa'(\rvy)$ are the parents in $G$ of
$\rvy$, excluding $\rvd$.
For $G_{im}$, $S_{\ul{\tild}}= S_\rvd$.
For the modified
imagined bnet $G_{im,mod}$, $S_{\ul{\tild}}\subset S_\rvd$. }
\label{fig-unmodi-modi}
\end{figure}

The TPM, printed in  blue, for node $\ul{\tild}$
of the imagined bnet $G_{im}$ in Fig.\ref{fig-unmodi-modi}, is as follows
\beq\color{blue}
P(\ul{\tild}=\tild) =\delta(\tild, d)
\eeq

The TPM, printed in  blue, for node $\ul{\tild}$
of the modified imagined bnet $G_{im,mod}$ in Fig.\ref{fig-unmodi-modi},
 is as follows
\beq\color{blue}
P(\ul{\tild}=\tild | \rvd=d, pa(\rvd)=x)= \text{ prior}
\eeq

Hence, node $\ul{\tild}$
has a non-informative (frequentist) prior in $G_{im}$,
and it has an informative (Bayesian) prior in $G_{im,mod}$.

Note that we must have $S_{\ul{\tild}}\subset S_\rvd$ in $G_{im,mod}$,
or else queries of the type
 $P(y(\tild)|pa'(\rvy)=c)$ are not identifiable.
This is clear because if $\tild\not\in S_\rvd$,
then we have no information of the type $P(y|\tild, pa'(\rvy)=c)$.


Examples of $\ul{\tild}$ priors for $G_{im,mod}$.
\begin{itemize}
\item example of a deterministic $\ul{\tild}$  prior

Suppose
$S_\rvd=\RR$,
$F$ is finite subset of $S_\rvd$,

$\Delta d\in \RR$,
$S_{\ul{\tild}}= F+\Delta d = \{d+\Delta d: d\in F\}$

$d\in F$, $\tild\in F+\Delta d$,

$\calx\subset S_{pa(\rvd)}$, $x\in S_{pa(\rvd)}$

$\tild_x(\cdot):F\rarrow F+\Delta d$

\beq
\tild_x(d) = d + \Delta d \;\indi(x\in \calx)
\label{eq-modi-da}
\eeq
Then

\beq\color{blue}
P(\ul{\tild}=\tild | \rvd=d, pa(\rvd)=x)= \delta(\tild, \tild_x(d))
\eeq

\item example of a stochastic $\ul{\tild}$  prior

Suppose $d_x(\tild)$ is the inverse of
the function $\tild_x(d)$ defined in Eq.(\ref{eq-modi-da}).
Hence

\beq
d_x(\tild) = \tild -\Delta d \;\indi(x\in \calx)
\eeq
Let $P(\rvd=d |pa(\rvd)=x)$ be the propensity for bnet $G$.
Then

\beq\color{blue}
P(\ul{\tild}=\tild | \rvd=d, pa(\rvd)=x)=
\frac{
e^{-\beta(d-d_x(\tild))^2} P(\rvd=d_x(\tild) |pa(\rvd)=x)}
{\sum_{\tild\in S_{\ul{\tild}}} \text{numerator}}
\eeq


\end{itemize}
