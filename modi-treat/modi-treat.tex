\chapter{Modified Treatment Policy}
\label{ch-modi-treat}

This  chapter
assumes that the
reader has
already read
Chapter \ref{ch-pot-out} on Potential Outcomes (PO) theory.

Consider a typical PO bnet $G$
and its corresponding imagined bnet $G_{im}$ (see Fig.\ref{fig-modi-po}).
A {\bf Modified Treatment Policy (MTP)} adds a Bayesian prior to the
 node $\ul{\tilx}$ in $G_{im}$.
The prior depends on the {\bf treatment
variable} (a.k.a., {\bf exposure variable}) $\rvx$ and its parents $pa(\rvx)$.
This adds arrows $pa(\rvx)\rarrow\ul{\tilx}$
and $\rvx\rarrow \ul{\tilx}$ (see Fig.\ref{fig-unmodi-modi}).
An ATE is calculated by removing all arrows entering $\ul{\tilx}$
so as to mimic a RCT. Hence, a MTP cannot be used to calculate
an ATE or mimic an RCT.


\begin{figure}[h!]
$$
\begin{array}{cc}
\xymatrix{
\rvw
\ar[dd]\ar[ddrr]
\\
\\
\rvx \ar[rr]
&
&\rvy
}
&
\xymatrix{
\rvw
\ar[dd]\ar[dr] \ar[drr]
\\
& \rvy(0)\ar[dr]
&\rvy(1)\ar[d]
\\
\rvx
&\ul{\tilx}=\tilx\ar[r]
&\rvy
}
\\
G & G_{im}
\end{array}
$$
\caption{$G$ is one of the
simplest possible bnets considered in  PO theory.
$G_{im}$ is the bnet that results
from applying the imagine operator to $G$.
For $G_{im}$, $\tilx\in S_{\ul{\tilx}}=S_\rvx=\bool$.}
\label{fig-modi-po}
\end{figure}


\begin{figure}[h!]
$$
\begin{array}{cc}
\xymatrix{
pa(\rvx)
\ar[dd]
&
&pa'(\rvy)\ar[d]
\\
&&[\rvy(\tilx)]_{x\in S_{\ul{\tilx}}}\ar[d]
\\
\rvx
&\ul{\tilx}=\tilx\ar[r]
&\rvy
}
&
\xymatrix{
pa(\rvx)
\ar[dd]\ar[ddr]
&
&pa'(\rvy)\ar[d]
\\
&&[\rvy(\tilx)]_{\tilx\in S_{\ul{\tilx}}}\ar[d]
\\
\rvx\ar[r]
&\ul{\tilx}\ar[r]
&\rvy
}
\\
G_{im}
 &
G_{im,mod}
\end{array}
$$
\caption{In this figure, $G_{im}$
is the generalization of the $G_{im}$
in Fig.\ref{fig-modi-po}.
Note that $pa'(\rvy)$ are, in $G$, the parents of
$\rvy$, excluding $\rvx$.
For $G_{im}$, $S_{\ul{\tilx}}= S_\rvx$.
For the modified
imagined bnet $G_{im,mod}$, $S_{\ul{\tilx}}\subset S_\rvx$. }
\label{fig-unmodi-modi}
\end{figure}

The TPM, printed in  blue, for node $\ul{\tilx}$
of the imagined bnet $G_{im}$ in Fig.\ref{fig-unmodi-modi}, is as follows
\beq\color{blue}
P(\ul{\tilx}=\tilx) =\delta(\tilx, x)
\eeq

The TPM, printed in  blue, for node $\ul{\tilx}$
of the modified imagined bnet $G_{im,mod}$ in Fig.\ref{fig-unmodi-modi},
 is as follows
\beq\color{blue}
P(\ul{\tilx}=\tilx | \rvx=x, pa(\rvx)=a)= \text{ prior}
\eeq

Hence, node $\ul{\tilx}$
has a non-informative (frequentist) prior in $G_{im}$,
and it has an informative (Bayesian) prior in $G_{im,mod}$.

Note that we must have $S_{\ul{\tilx}}\subset S_\rvx$ in $G_{im,mod}$,
or else queries of the type
 $P(y(\tilx)|pa'(\rvy)=c)$ are not identifiable.
This is clear because if $\tilx\not\in S_\rvx$,
then we have no information of the type $P(y|\tilx, pa'(\rvy)=c)$.


Examples of $\ul{\tilx}$ priors for $G_{im,mod}$.
\begin{itemize}
\item example of a deterministic $\ul{\tilx}$  prior

Suppose
$S_\rvx=\RR$,
$F$ is finite subset of $S_\rvx$,

$\Delta x\in \RR$,
$S_{\ul{\tilx}}= F+\Delta x = \{x+\Delta x: x\in F\}$

$x\in F$, $\tilx\in F+\Delta x$,

$A\subset S_{pa(\rvx)}$, $a\in S_{pa(\rvx)}$

$\tilx_a(\cdot):F\rarrow F+\Delta x$

\beq
\tilx_a(x) = x + \Delta x \indi(a\in A)
\label{eq-modi-xa}
\eeq
Then

\beq\color{blue}
P(\ul{\tilx}=\tilx | \rvx=x, pa(\rvx)=a)= \delta(\tilx, \tilx_a(x))
\eeq

\item example of a stochastic $\ul{\tilx}$  prior

Suppose $x_a(\tilx)$ is the inverse of
the function $\tilx_a(x)$ defined in Eq.(\ref{eq-modi-xa}).
Hence

\beq
x_a(\tilx) = \tilx -\Delta x \indi(a\in A)
\eeq
Let $P(\rvx=x |pa(\rvx)=a)$ be the propensity for bnet $G$.
Then

\beq\color{blue}
P(\ul{\tilx}=\tilx | \rvx=x, pa(\rvx)=a)=
\frac{
e^{-\beta(x-x_a(\tilx))^2} P(\rvx=x_a(\tilx) |pa(\rvx)=a)}
{\sum_{\tilx\in S_{\ul{\tilx}}} \text{numerator}}
\eeq


\end{itemize}
